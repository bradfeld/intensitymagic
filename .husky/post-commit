#!/bin/sh

# Auto-sync global config files after commit
# If GLOBAL_STANDARDS.md or mcp.json were committed, sync to ~/.claude/

CHANGED_FILES=$(git diff-tree --no-commit-id --name-only -r HEAD)

# Check if any global config files were changed
if echo "$CHANGED_FILES" | grep -q "\.claude/GLOBAL_STANDARDS\.md\|\.claude/mcp\.json"; then
  echo ""
  echo "ðŸ“‹ Global config files changed - syncing to ~/.claude/"

  # Copy to global ~/.claude/ directory
  if echo "$CHANGED_FILES" | grep -q "\.claude/GLOBAL_STANDARDS\.md"; then
    cp .claude/GLOBAL_STANDARDS.md ~/.claude/GLOBAL_STANDARDS.md
    echo "  âœ… Synced GLOBAL_STANDARDS.md to ~/.claude/"
  fi

  if echo "$CHANGED_FILES" | grep -q "\.claude/mcp\.json"; then
    cp .claude/mcp.json ~/.claude/mcp.json
    echo "  âœ… Synced mcp.json to ~/.claude/"
  fi

  echo ""
  echo "ðŸ’¡ To share with other projects:"
  echo "   ./scripts/sync-config.sh push  # Push to project-template"
  echo "   cd /Code/other-project && ./scripts/sync-config.sh pull  # Pull in other projects"
  echo ""
fi
